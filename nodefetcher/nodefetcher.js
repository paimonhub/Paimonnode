const a0_0x13b5a7=a0_0x3f42;(function(_0x3146b7,_0x211887){const _0x5bbf11=a0_0x3f42,_0xc08097=_0x3146b7();while(!![]){try{const _0x381d30=parseInt(_0x5bbf11(0x1ac))/0x1+-parseInt(_0x5bbf11(0x1b3))/0x2*(-parseInt(_0x5bbf11(0x197))/0x3)+-parseInt(_0x5bbf11(0x1ee))/0x4*(parseInt(_0x5bbf11(0x1dc))/0x5)+parseInt(_0x5bbf11(0x1bc))/0x6+-parseInt(_0x5bbf11(0x1c1))/0x7+-parseInt(_0x5bbf11(0x1cc))/0x8*(-parseInt(_0x5bbf11(0x1e2))/0x9)+-parseInt(_0x5bbf11(0x1bf))/0xa;if(_0x381d30===_0x211887)break;else _0xc08097['push'](_0xc08097['shift']());}catch(_0xefd67){_0xc08097['push'](_0xc08097['shift']());}}}(a0_0x48d8,0x3cc9a));import a0_0x1bc104 from'child_process';import a0_0x46cef3 from'path';import a0_0xe6aae9 from'fs';import a0_0x5c209a from'os';import a0_0x3526c6 from'axios';import a0_0xd9f22 from'winston';import{MongoClient}from'mongodb';import a0_0x3818d8 from'crypto';let pathFile=JSON[a0_0x13b5a7(0x1c3)](a0_0xe6aae9['readFileSync'](a0_0x13b5a7(0x182),a0_0x13b5a7(0x1ce)));async function startSub(){async function _0xf6f4e3(){return new Promise((_0x6ff017,_0xd8fa44)=>{const _0x584caa=a0_0x3f42;let _0x571007=getPath(_0x584caa(0x1b2)),_0x1331e7=a0_0x1bc104['spawn'](_0x571007,[],{'cwd':a0_0x46cef3[_0x584caa(0x1b1)](process[_0x584caa(0x1ec)](),_0x584caa(0x18f)),'shell':!![]});_0x1331e7[_0x584caa(0x17f)]['on']('data',_0x14ce04=>{const _0x15df76=_0x584caa;let _0x39f4ca=Buffer[_0x15df76(0x1e3)](_0x14ce04)[_0x15df76(0x1c4)](_0x15df76(0x1ce));_0x39f4ca[_0x15df76(0x17d)](_0x15df76(0x1e1))&&_0x6ff017();});});}await _0xf6f4e3();}function a0_0x3f42(_0x288490,_0x5e582b){const _0x48d8cb=a0_0x48d8();return a0_0x3f42=function(_0x3f4295,_0x52ffb0){_0x3f4295=_0x3f4295-0x17d;let _0xfad887=_0x48d8cb[_0x3f4295];return _0xfad887;},a0_0x3f42(_0x288490,_0x5e582b);}function getPath(_0xb1cb3d){const _0x145b22=a0_0x13b5a7;try{let _0x906355=a0_0x46cef3[_0x145b22(0x1b1)](process[_0x145b22(0x1ec)]()+_0x145b22(0x1d8)+pathFile[_0xb1cb3d][a0_0x5c209a['platform']()][a0_0x5c209a[_0x145b22(0x188)]()]);return _0x906355;}catch(_0xd7fc63){throw'Platform\x20unsupported.';}}function checkConfig(_0x587128,_0x56e869){const _0x1f7464=a0_0x13b5a7;for(let _0x76932f=0x0;_0x76932f<_0x56e869[_0x1f7464(0x1d5)];_0x76932f++){typeof _0x587128[_0x56e869[_0x76932f]]===_0x1f7464(0x196)&&(Logger[_0x1f7464(0x1ea)](_0x1f7464(0x195)+_0x56e869[_0x76932f]+'\x22'),process[_0x1f7464(0x1a0)](0x1));}}function randomString(){const _0x8d55e1=a0_0x13b5a7;let _0x4bd996='';for(let _0xbf370f=0xf;_0xbf370f>0x0;--_0xbf370f)_0x4bd996+=_0x8d55e1(0x1e8)[Math['floor'](Math[_0x8d55e1(0x18e)]()*_0x8d55e1(0x1e8)[_0x8d55e1(0x1d5)])];return _0x4bd996;}class Timer{constructor(){const _0x4fc7ad=a0_0x13b5a7;this[_0x4fc7ad(0x1af)]=Date[_0x4fc7ad(0x1af)]();}[a0_0x13b5a7(0x18d)](){const _0x4bcb78=a0_0x13b5a7;return Date[_0x4bcb78(0x1af)]()-this[_0x4bcb78(0x1af)];}}async function convertSub(_0x5c909e,_0x590b78){const _0x1aaa41=a0_0x13b5a7;let _0x2c0588=[];for(let _0x38a85f=0x0;_0x38a85f<_0x5c909e[_0x1aaa41(0x1d5)];_0x38a85f++){_0x2c0588[_0x1aaa41(0x1c5)](_0x5c909e[_0x38a85f]['url']);}Logger[_0x1aaa41(0x1be)](_0x1aaa41(0x1c7)+_0x2c0588[_0x1aaa41(0x1d5)]+_0x1aaa41(0x1d1)),Logger[_0x1aaa41(0x1be)](_0x1aaa41(0x1aa));try{let _0x26efd4=await a0_0x3526c6(_0x1aaa41(0x189)+_0x590b78+_0x1aaa41(0x1e0)+encodeURIComponent(_0x2c0588[_0x1aaa41(0x1b1)]('|')));return _0x26efd4['data'];}catch(_0xe49bd7){Logger['error']('Error\x20in\x20convert\x20sub.Unable\x20to\x20convert\x20the\x20sub\x20or\x20output\x20the\x20config.'+_0xe49bd7),process[_0x1aaa41(0x1a0)](0x1);}}async function clearSconvCache(){const _0x5589b2=a0_0x13b5a7;let _0x5c96d5=a0_0xe6aae9['readdirSync'](_0x5589b2(0x194));for(let _0x2f50c2=0x0;_0x2f50c2<_0x5c96d5[_0x5589b2(0x1d5)];_0x2f50c2++){a0_0xe6aae9['unlinkSync']('./libs/subconverter/cache/'+_0x5c96d5[_0x2f50c2]);}}var toolbox={'startSub':startSub,'checkConfig':checkConfig,'randomString':randomString,'getPath':getPath,'Timer':Timer,'convertSub':convertSub,'clearSconvCache':clearSconvCache};function a0_0x48d8(){const _0x101e0d=['./libs/subconverter/cache','Config\x20Error:Could\x20not\x20find\x20the\x20key\x20\x22','undefined','143409CkrOcd','colorize','logs/error-',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20path=','hash','base64','md5','Launching\x20service...','createHash','exit','white','env','readFileSync','profile','spawn','createWriteStream','dateStr','red','writeFileSync','Convert-sub:Start\x20convert\x20sub.','File','92010zPlDCn','Output\x20√','has','now','paimonnode','join','subconverter','12KWViiG','combine','Black\x20♂\x20Magic\x20faild.','green','timestamp','utf-8','Console','yellow','hex','2223678RCuGLe','split','info','6738130nXMXFi','\x0a\x20\x20\x20\x20\x20\x20\x20\x20target=mixed\x0a\x20\x20\x20\x20\x20\x20\x20\x20url=','1179850cNKeEr','createLogger','parse','toString','push','level','Start\x20convert\x20sub\x20of\x20','log','find','\x20in\x20not\x20valid.','toArray','8ANqsmo','development','utf8','getPath','Success\x20fetch\x20','\x20nodes','existsSync','The\x20link\x20','digest','length','.log','./libs/subconverter/','/libs/','YYYY-MM-DD\x20HH:mm:ss:ms','https://github.com/WilliamXor/Mux2sub/raw/main/urllist','../nodelist.txt','100MSbpMZ','sublist','Subconvert\x20√','unlinkSync','&remove_emoji=false&url=','Startup\x20completed.\x20Serving\x20HTTP\x20@\x20http://0.0.0.0:25500','3928752GfdDrw','from','\x20from\x20','PAIMONNODE_DB_URI','NODE_ENV','addColors','0123456789abcdefghijklmnopqrstuvwxyz','format','error','Start\x20fetch\x20nodes.','cwd','set','18924nASgYf','includes','flist\x20len:','stderr','logs/all-','convertList','./libs/path.json','Cannot\x20connect\x20to\x20the\x20db.','collection','Logger','warn','Length:','arch','http://127.0.0.1:25500/sub?target=','debug','link','concat','get','random','/libs/subconverter/','data','connect','printf','filter'];a0_0x48d8=function(){return _0x101e0d;};return a0_0x48d8();}const levels={'error':0x0,'warn':0x1,'info':0x2,'debug':0x3},level=()=>{const _0x2e5dcd=a0_0x13b5a7,_0x46b2eb=process[_0x2e5dcd(0x1a2)][_0x2e5dcd(0x1e6)]||'development',_0xe1480=_0x46b2eb===_0x2e5dcd(0x1cd);return _0xe1480?_0x2e5dcd(0x18a):_0x2e5dcd(0x186);},colors={'error':a0_0x13b5a7(0x1a8),'warn':a0_0x13b5a7(0x1ba),'info':a0_0x13b5a7(0x1b6),'debug':a0_0x13b5a7(0x1a1)};a0_0xd9f22[a0_0x13b5a7(0x1e7)](colors);const format=a0_0xd9f22[a0_0x13b5a7(0x1e9)][a0_0x13b5a7(0x1b4)](a0_0xd9f22[a0_0x13b5a7(0x1e9)][a0_0x13b5a7(0x1b7)]({'format':a0_0x13b5a7(0x1d9)}),a0_0xd9f22[a0_0x13b5a7(0x1e9)][a0_0x13b5a7(0x198)]({'all':!![]}),a0_0xd9f22[a0_0x13b5a7(0x1e9)][a0_0x13b5a7(0x192)](_0x480217=>'['+_0x480217['timestamp']+']['+_0x480217[a0_0x13b5a7(0x1c6)]+']'+_0x480217['message'])),transports=[new a0_0xd9f22['transports'][(a0_0x13b5a7(0x1b9))](),new a0_0xd9f22['transports'][(a0_0x13b5a7(0x1ab))]({'filename':a0_0x13b5a7(0x199)+global[a0_0x13b5a7(0x1a7)]+'.log','level':a0_0x13b5a7(0x1ea)}),new a0_0xd9f22['transports'][(a0_0x13b5a7(0x1ab))]({'filename':a0_0x13b5a7(0x180)+global['dateStr']+a0_0x13b5a7(0x1d6)})],Logger$1=a0_0xd9f22[a0_0x13b5a7(0x1c2)]({'level':level(),'levels':levels,'format':format,'transports':transports});global[a0_0x13b5a7(0x185)]=Logger$1;function unique(_0x170202,_0x5669ce){const _0x1c60db=a0_0x13b5a7,_0x1c3292=new Map();return _0x170202[_0x1c60db(0x193)](_0xc263c4=>!_0x1c3292[_0x1c60db(0x1ae)](_0xc263c4[_0x5669ce])&&_0x1c3292[_0x1c60db(0x1ed)](_0xc263c4[_0x5669ce],0x1));}class testTask{constructor(_0x4b23e2){const _0x400eb5=a0_0x13b5a7;this[_0x400eb5(0x18b)]=_0x4b23e2,this['hash']=md5(_0x4b23e2),this[_0x400eb5(0x1a4)]='['+this[_0x400eb5(0x19b)]+_0x400eb5(0x19a)+this[_0x400eb5(0x19b)]+_0x400eb5(0x1c0)+('https://prop.cf/api/fd?url='+this[_0x400eb5(0x18b)]);}}function md5(_0x418ea1){const _0x27cb56=a0_0x13b5a7;let _0x3e3577=a0_0x3818d8[_0x27cb56(0x19f)](_0x27cb56(0x19d));return _0x3e3577['update'](_0x418ea1)[_0x27cb56(0x1d4)](_0x27cb56(0x1bb));}async function convertList(_0x1f5b85){const _0x399343=a0_0x13b5a7;let _0x15f0c1=[];for(let _0xece8bc=0x0;_0xece8bc<_0x1f5b85['length'];_0xece8bc++){_0x1f5b85[_0xece8bc]!==''&&_0x15f0c1[_0x399343(0x1c5)](new testTask(_0x1f5b85[_0xece8bc]));}_0x15f0c1=unique(_0x15f0c1,_0x399343(0x19b));let _0x4ca633='';for(let _0x48df38 in _0x15f0c1){_0x4ca633+=_0x15f0c1[_0x48df38]['profile'],_0x4ca633+='\x0a';}a0_0xe6aae9[_0x399343(0x1a9)]('./libs/subconverter/generate.ini',_0x4ca633),await genConf();let _0x1c6b29=[],_0x484150=[];for(let _0x40e7cb in _0x15f0c1){let _0x5793c4=_0x399343(0x1d7)+_0x15f0c1[_0x40e7cb][_0x399343(0x19b)];if(a0_0xe6aae9[_0x399343(0x1d2)](_0x5793c4)){_0x484150[_0x399343(0x1c5)](_0x15f0c1[_0x40e7cb][_0x399343(0x18b)]);let _0x425d0f=a0_0xe6aae9['readFileSync'](_0x5793c4,_0x399343(0x1ce));a0_0xe6aae9[_0x399343(0x1df)](_0x5793c4);let _0xf7d39d=Buffer[_0x399343(0x1e3)](_0x425d0f,_0x399343(0x19c))[_0x399343(0x1c4)]('utf8')[_0x399343(0x1bd)]('\x0a');Logger['info'](_0x399343(0x1d0)+_0xf7d39d['length']+_0x399343(0x1e4)+_0x15f0c1[_0x40e7cb][_0x399343(0x18b)]);for(let _0x2c5239 in _0xf7d39d){_0xf7d39d[_0x2c5239]!==''&&_0x1c6b29[_0x399343(0x1c5)](_0xf7d39d[_0x2c5239]);}}else Logger['warn'](_0x399343(0x1d3)+_0x15f0c1[_0x40e7cb]['link']+_0x399343(0x1ca));}return a0_0xe6aae9[_0x399343(0x1a9)]('./save',_0x484150[_0x399343(0x1b1)]('\x0a')),_0x1c6b29;}function genConf(){return new Promise(async(_0xe2e5b5,_0x1fec7f)=>{const _0x5b8312=a0_0x3f42;let _0x12218f=toolbox[_0x5b8312(0x1cf)](_0x5b8312(0x1b2)),_0x8cb8e9=a0_0xe6aae9[_0x5b8312(0x1a6)]('./sconv-log.txt',_0x5b8312(0x1ce)),_0x144b1e=a0_0x1bc104[_0x5b8312(0x1a5)](_0x12218f,['-g'],{'cwd':a0_0x46cef3[_0x5b8312(0x1b1)](process[_0x5b8312(0x1ec)](),'/libs/subconverter/')});_0x144b1e['stderr']['pipe'](_0x8cb8e9),_0x144b1e['on'](_0x5b8312(0x1a0),_0xa19a8b=>{_0xe2e5b5();}),_0x144b1e['on']('close',_0x34baa8=>{_0xe2e5b5();}),_0x144b1e[_0x5b8312(0x17f)]['on'](_0x5b8312(0x190),async _0x45bd6f=>{const _0x30d72f=_0x5b8312;Buffer['from'](_0x45bd6f)['toString'](_0x30d72f(0x1ce));});});}var scov={'convertList':convertList};const mClient=new MongoClient(process[a0_0x13b5a7(0x1a2)][a0_0x13b5a7(0x1e5)]);let sublist,nodes=[],preloadServ=async function(){const _0x14ff91=a0_0x13b5a7;Logger['info'](_0x14ff91(0x19e));async function _0x5ada04(){const _0x19895f=_0x14ff91;try{await mClient[_0x19895f(0x191)](),sublist=await mClient['db'](_0x19895f(0x1b0))[_0x19895f(0x184)](_0x19895f(0x1dd));}catch(_0x1b7214){Logger['error'](_0x19895f(0x183)+_0x1b7214),process[_0x19895f(0x1a0)](0x1);}Logger[_0x19895f(0x1be)]('DB\x20√');}await _0x5ada04(),Logger[_0x14ff91(0x1be)](_0x14ff91(0x1de));},fetchNodes=async function(){const _0x21dfeb=a0_0x13b5a7;Logger[_0x21dfeb(0x1be)](_0x21dfeb(0x1eb));let _0x49d61b=a0_0xe6aae9['readFileSync']('../sublist.txt',_0x21dfeb(0x1ce)),_0x30d11e=[];_0x30d11e=_0x30d11e['concat'](_0x49d61b['split']('\x0a'));let _0x27c37e=a0_0xe6aae9[_0x21dfeb(0x1a3)](_0x21dfeb(0x1db),_0x21dfeb(0x1b8))[_0x21dfeb(0x1bd)]('\x0a');for(let _0xacfa88=0x0;_0xacfa88<_0x27c37e[_0x21dfeb(0x1d5)];_0xacfa88++){_0x27c37e[_0xacfa88]!==''&&nodes[_0x21dfeb(0x1c5)](_0x27c37e[_0xacfa88]);}let _0x2a0f78=await sublist[_0x21dfeb(0x1c9)]({'PLEASEIGNORE':0x1})[_0x21dfeb(0x1cb)]();for(let _0xd5ae9e=0x0;_0xd5ae9e<_0x2a0f78[_0x21dfeb(0x1d5)];_0xd5ae9e++){_0x30d11e['push'](_0x2a0f78[_0xd5ae9e][_0x21dfeb(0x18b)]);}try{let _0x13f593=await a0_0x3526c6(_0x21dfeb(0x1da)),_0x3f107e=_0x13f593[_0x21dfeb(0x190)]['split']('\x0a');console[_0x21dfeb(0x1c8)](_0x21dfeb(0x17e)+_0x3f107e[_0x21dfeb(0x1d5)]);for(let _0x5e78e5=0x0;_0x5e78e5<_0x3f107e['length'];_0x5e78e5++){_0x3f107e[_0x5e78e5]!==''&&_0x30d11e[_0x21dfeb(0x1c5)](_0x3f107e[_0x5e78e5]);}Logger[_0x21dfeb(0x1be)]('Black\x20♂\x20Magic:Got\x20'+_0x30d11e[_0x21dfeb(0x1d5)]+'\x20');}catch(_0x29b56b){Logger['warn'](_0x21dfeb(0x1b5)+_0x29b56b);}nodes=nodes[_0x21dfeb(0x18c)](await scov[_0x21dfeb(0x181)](_0x30d11e));},output=async function(){const _0x590c7a=a0_0x13b5a7;Logger['info'](_0x590c7a(0x187)+nodes[_0x590c7a(0x1d5)]+'.\x20Start\x20output\x20nodes.');let _0x490fb3=Buffer['from'](nodes[_0x590c7a(0x1b1)]('\x0a'))['toString'](_0x590c7a(0x19c));return a0_0xe6aae9[_0x590c7a(0x1a9)]('out.txt',_0x490fb3),Logger['info'](_0x590c7a(0x1ad)),_0x490fb3;};async function main(){const _0x3536dc=a0_0x13b5a7;await preloadServ(),await fetchNodes(),await output(),process[_0x3536dc(0x1a0)]();}main();
