const _0x127e81=_0x5c1e;(function(_0x39c908,_0x5dfd33){const _0x5e0a72=_0x5c1e,_0x47a033=_0x39c908();while(!![]){try{const _0x911b68=-parseInt(_0x5e0a72(0x1d9))/0x1*(-parseInt(_0x5e0a72(0x223))/0x2)+-parseInt(_0x5e0a72(0x1e0))/0x3*(-parseInt(_0x5e0a72(0x210))/0x4)+-parseInt(_0x5e0a72(0x21b))/0x5*(-parseInt(_0x5e0a72(0x243))/0x6)+-parseInt(_0x5e0a72(0x235))/0x7*(-parseInt(_0x5e0a72(0x231))/0x8)+parseInt(_0x5e0a72(0x1fd))/0x9*(-parseInt(_0x5e0a72(0x1da))/0xa)+parseInt(_0x5e0a72(0x1e9))/0xb+-parseInt(_0x5e0a72(0x239))/0xc*(parseInt(_0x5e0a72(0x20b))/0xd);if(_0x911b68===_0x5dfd33)break;else _0x47a033['push'](_0x47a033['shift']());}catch(_0x482bae){_0x47a033['push'](_0x47a033['shift']());}}}(_0x576b,0x98ded));const _0x2f6934=(function(){let _0x5d777b=!![];return function(_0xfb03a3,_0x43ae96){const _0x19b6bd=_0x5d777b?function(){const _0x1fbf80=_0x5c1e;if(_0x43ae96){const _0x401486=_0x43ae96[_0x1fbf80(0x22e)](_0xfb03a3,arguments);return _0x43ae96=null,_0x401486;}}:function(){};return _0x5d777b=![],_0x19b6bd;};}()),_0x2b1c2a=_0x2f6934(this,function(){const _0x3b8a56=_0x5c1e;return _0x2b1c2a[_0x3b8a56(0x244)]()[_0x3b8a56(0x23f)]('(((.+)+)+)+$')['toString']()[_0x3b8a56(0x1d8)](_0x2b1c2a)[_0x3b8a56(0x23f)](_0x3b8a56(0x21e));});_0x2b1c2a();import _0x30ae01 from'child_process';import _0x13eb8c from'path';import _0x38a795 from'fs';import _0x2fb60b from'os';function _0x5c1e(_0xfca8c2,_0x2d4bec){const _0x2fc3dc=_0x576b();return _0x5c1e=function(_0x2b1c2a,_0x2f6934){_0x2b1c2a=_0x2b1c2a-0x1d8;let _0x576b82=_0x2fc3dc[_0x2b1c2a];return _0x576b82;},_0x5c1e(_0xfca8c2,_0x2d4bec);}import _0x404bcf from'axios';import _0xa67ba6 from'winston';import{MongoClient}from'mongodb';import _0x57ee53 from'crypto';let pathFile=JSON[_0x127e81(0x21c)](_0x38a795[_0x127e81(0x232)](_0x127e81(0x228),_0x127e81(0x1e1)));async function startSub(){async function _0xa56336(){return new Promise((_0x3df7e1,_0x448d46)=>{const _0x4b4796=_0x5c1e;let _0x48c128=getPath('subconverter'),_0x50d620=_0x30ae01[_0x4b4796(0x1e6)](_0x48c128,[],{'cwd':_0x13eb8c[_0x4b4796(0x227)](process[_0x4b4796(0x217)](),_0x4b4796(0x201)),'shell':!![]});_0x50d620[_0x4b4796(0x20e)]['on'](_0x4b4796(0x21a),_0x38d543=>{const _0x46e736=_0x4b4796;let _0x5ae2b6=Buffer[_0x46e736(0x23c)](_0x38d543)[_0x46e736(0x244)](_0x46e736(0x1e1));_0x5ae2b6[_0x46e736(0x204)](_0x46e736(0x234))&&_0x3df7e1();});});}await _0xa56336();}function getPath(_0x362067){const _0x282992=_0x127e81;try{let _0x985dc1=_0x13eb8c['join'](process[_0x282992(0x217)]()+_0x282992(0x1ea)+pathFile[_0x362067][_0x2fb60b[_0x282992(0x247)]()][_0x2fb60b[_0x282992(0x208)]()]);return _0x985dc1;}catch(_0x3b9a69){throw _0x282992(0x1e5);}}function checkConfig(_0x1d463c,_0x42162b){const _0xa74785=_0x127e81;for(let _0x236587=0x0;_0x236587<_0x42162b[_0xa74785(0x1fb)];_0x236587++){typeof _0x1d463c[_0x42162b[_0x236587]]===_0xa74785(0x203)&&(Logger[_0xa74785(0x215)](_0xa74785(0x20f)+_0x42162b[_0x236587]+'\x22'),process[_0xa74785(0x1e7)](0x1));}}function randomString(){const _0x112952=_0x127e81;let _0x240610='';for(let _0x2ff9eb=0xf;_0x2ff9eb>0x0;--_0x2ff9eb)_0x240610+='0123456789abcdefghijklmnopqrstuvwxyz'[Math['floor'](Math[_0x112952(0x1de)]()*'0123456789abcdefghijklmnopqrstuvwxyz'[_0x112952(0x1fb)])];return _0x240610;}class Timer{constructor(){const _0x4fd7d7=_0x127e81;this[_0x4fd7d7(0x238)]=Date[_0x4fd7d7(0x238)]();}[_0x127e81(0x20c)](){const _0x2352cf=_0x127e81;return Date[_0x2352cf(0x238)]()-this['now'];}}async function convertSub(_0x1e3b92,_0x3a822e){const _0x8ef5bc=_0x127e81;let _0x4fce6d=[];for(let _0x313bfa=0x0;_0x313bfa<_0x1e3b92[_0x8ef5bc(0x1fb)];_0x313bfa++){_0x4fce6d[_0x8ef5bc(0x23a)](_0x1e3b92[_0x313bfa][_0x8ef5bc(0x206)]);}Logger[_0x8ef5bc(0x1fc)](_0x8ef5bc(0x213)+_0x4fce6d[_0x8ef5bc(0x1fb)]+_0x8ef5bc(0x220)),Logger[_0x8ef5bc(0x1fc)](_0x8ef5bc(0x1eb));try{let _0x3df311=await _0x404bcf(_0x8ef5bc(0x20d)+_0x3a822e+'&remove_emoji=false&url='+encodeURIComponent(_0x4fce6d['join']('|')));return _0x3df311[_0x8ef5bc(0x21a)];}catch(_0xb17951){Logger[_0x8ef5bc(0x215)](_0x8ef5bc(0x1f7)+_0xb17951),process[_0x8ef5bc(0x1e7)](0x1);}}async function clearSconvCache(){const _0x2f7da5=_0x127e81;let _0xf99d32=_0x38a795[_0x2f7da5(0x1e8)](_0x2f7da5(0x22d));for(let _0x1592b8=0x0;_0x1592b8<_0xf99d32[_0x2f7da5(0x1fb)];_0x1592b8++){_0x38a795[_0x2f7da5(0x1dc)]('./libs/subconverter/cache/'+_0xf99d32[_0x1592b8]);}}var toolbox={'startSub':startSub,'checkConfig':checkConfig,'randomString':randomString,'getPath':getPath,'Timer':Timer,'convertSub':convertSub,'clearSconvCache':clearSconvCache};const levels={'error':0x0,'warn':0x1,'info':0x2,'debug':0x3},level=()=>{const _0x1ab119=_0x127e81,_0xd01a4=process[_0x1ab119(0x202)][_0x1ab119(0x23d)]||_0x1ab119(0x24b),_0x351ace=_0xd01a4==='development';return _0x351ace?_0x1ab119(0x241):'warn';},colors={'error':_0x127e81(0x20a),'warn':_0x127e81(0x1e3),'info':_0x127e81(0x212),'debug':_0x127e81(0x1fa)};_0xa67ba6[_0x127e81(0x1f8)](colors);const format=_0xa67ba6[_0x127e81(0x1ed)][_0x127e81(0x1e2)](_0xa67ba6['format']['timestamp']({'format':_0x127e81(0x246)}),_0xa67ba6['format'][_0x127e81(0x236)]({'all':!![]}),_0xa67ba6['format']['printf'](_0x30de0f=>'['+_0x30de0f[_0x127e81(0x21d)]+']['+_0x30de0f[_0x127e81(0x22c)]+']'+_0x30de0f[_0x127e81(0x237)])),transports=[new _0xa67ba6[(_0x127e81(0x1ef))][(_0x127e81(0x218))](),new _0xa67ba6[(_0x127e81(0x1ef))][(_0x127e81(0x248))]({'filename':_0x127e81(0x23e)+global['dateStr']+'.log','level':_0x127e81(0x215)}),new _0xa67ba6[(_0x127e81(0x1ef))][(_0x127e81(0x248))]({'filename':_0x127e81(0x221)+global[_0x127e81(0x23b)]+_0x127e81(0x1f5)})],Logger$1=_0xa67ba6[_0x127e81(0x1f1)]({'level':level(),'levels':levels,'format':format,'transports':transports});global[_0x127e81(0x1f3)]=Logger$1;function unique(_0x3d5775,_0x345e9d){const _0xde285f=_0x127e81,_0x320f99=new Map();return _0x3d5775['filter'](_0x3fd8a0=>!_0x320f99['has'](_0x3fd8a0[_0x345e9d])&&_0x320f99[_0xde285f(0x1f4)](_0x3fd8a0[_0x345e9d],0x1));}function _0x576b(){const _0x1d7df4=['7007970rFgZbq','log','unlinkSync','update','random','./libs/subconverter/','3052377Ccrhfw','utf8','combine','yellow','hash','Platform\x20unsupported.','spawn','exit','readdirSync','2741970kHDljj','/libs/','Convert-sub:Start\x20convert\x20sub.','Black\x20♂\x20Magic\x20faild.','format','digest','transports','subconverter','createLogger','./libs/subconverter/generate.ini','Logger','set','.log','existsSync','Error\x20in\x20convert\x20sub.Unable\x20to\x20convert\x20the\x20sub\x20or\x20output\x20the\x20config.','addColors','warn','white','length','info','9ywrxQZ','convertList','toArray',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20path=','/libs/subconverter/','env','undefined','includes','paimonnode','url','Length:','arch','find','red','8264737zYNNHL','get','http://127.0.0.1:25500/sub?target=','stderr','Config\x20Error:Could\x20not\x20find\x20the\x20key\x20\x22','4TRGnME','sublist','green','Start\x20convert\x20sub\x20of\x20','utf-8','error','collection','cwd','Console','connect','data','31505AgevXx','parse','timestamp','(((.+)+)+)+$','Black\x20♂\x20Magic:Got\x20','\x20nodes','logs/all-','PAIMONNODE_DB_URI','8926wiooay','Success\x20fetch\x20','concat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20target=mixed\x0a\x20\x20\x20\x20\x20\x20\x20\x20url=','join','./libs/path.json','Start\x20fetch\x20nodes.','link','split','level','./libs/subconverter/cache','apply','\x20from\x20','../sublist.txt','3984ftkpaC','readFileSync','Output\x20√','Startup\x20completed.\x20Serving\x20HTTP\x20@\x20http://0.0.0.0:25500','2716wnnYla','colorize','message','now','12ZLchaa','push','dateStr','from','NODE_ENV','logs/error-','search','.\x20Start\x20output\x20nodes.','debug','close','126bOlWgq','toString','writeFileSync','YYYY-MM-DD\x20HH:mm:ss:ms','platform','File','profile','Cannot\x20connect\x20to\x20the\x20db.','development','constructor','83udjOAt'];_0x576b=function(){return _0x1d7df4;};return _0x576b();}class testTask{constructor(_0x4445be){const _0x436833=_0x127e81;this['link']=_0x4445be,this[_0x436833(0x1e4)]=md5(_0x4445be),this[_0x436833(0x249)]='['+this[_0x436833(0x1e4)]+_0x436833(0x200)+this[_0x436833(0x1e4)]+_0x436833(0x226)+this[_0x436833(0x22a)];}}function md5(_0x2ea333){const _0x5b69e8=_0x127e81;let _0x3d7968=_0x57ee53['createHash']('md5');return _0x3d7968[_0x5b69e8(0x1dd)](_0x2ea333)[_0x5b69e8(0x1ee)]('hex');}async function convertList(_0x3d411c){const _0x339867=_0x127e81;let _0x40c09f=[];for(let _0x2aa6d0=0x0;_0x2aa6d0<_0x3d411c[_0x339867(0x1fb)];_0x2aa6d0++){_0x3d411c[_0x2aa6d0]!==''&&_0x40c09f[_0x339867(0x23a)](new testTask(_0x3d411c[_0x2aa6d0]));}_0x40c09f=unique(_0x40c09f,_0x339867(0x1e4));let _0x5cd51b='';for(let _0x1fae6e in _0x40c09f){_0x5cd51b+=_0x40c09f[_0x1fae6e][_0x339867(0x249)],_0x5cd51b+='\x0a';}_0x38a795['writeFileSync'](_0x339867(0x1f2),_0x5cd51b),await genConf();let _0x5a14b7=[],_0x231b7f=[];for(let _0x1dc9a7 in _0x40c09f){let _0x227495=_0x339867(0x1df)+_0x40c09f[_0x1dc9a7][_0x339867(0x1e4)];if(_0x38a795[_0x339867(0x1f6)](_0x227495)){_0x231b7f[_0x339867(0x23a)](_0x40c09f[_0x1dc9a7]['link']);let _0x3e02bc=_0x38a795[_0x339867(0x232)](_0x227495,_0x339867(0x1e1));_0x38a795[_0x339867(0x1dc)](_0x227495);let _0x4d676e=Buffer[_0x339867(0x23c)](_0x3e02bc,'base64')[_0x339867(0x244)](_0x339867(0x1e1))[_0x339867(0x22b)]('\x0a');Logger[_0x339867(0x1fc)](_0x339867(0x224)+_0x4d676e[_0x339867(0x1fb)]+_0x339867(0x22f)+_0x40c09f[_0x1dc9a7][_0x339867(0x22a)]);for(let _0x327849 in _0x4d676e){_0x4d676e[_0x327849]!==''&&_0x5a14b7[_0x339867(0x23a)](_0x4d676e[_0x327849]);}}}return _0x38a795[_0x339867(0x245)]('./save',_0x231b7f['join']('\x0a')),_0x5a14b7;}function genConf(){return new Promise(async(_0x5bec03,_0x2b0d4e)=>{const _0x1a900a=_0x5c1e;let _0x21af79=toolbox['getPath'](_0x1a900a(0x1f0)),_0x4124ca=_0x30ae01[_0x1a900a(0x1e6)](_0x21af79,['-g'],{'cwd':_0x13eb8c[_0x1a900a(0x227)](process['cwd'](),_0x1a900a(0x201))});_0x4124ca['on'](_0x1a900a(0x1e7),_0x432d5e=>{_0x5bec03();}),_0x4124ca['on'](_0x1a900a(0x242),_0x2de5a7=>{_0x5bec03();}),_0x4124ca[_0x1a900a(0x20e)]['on']('data',async _0x57b2cf=>{const _0x7084ad=_0x1a900a;Buffer['from'](_0x57b2cf)['toString'](_0x7084ad(0x1e1));});});}var scov={'convertList':convertList};const mClient=new MongoClient(process[_0x127e81(0x202)][_0x127e81(0x222)]);let sublist,nodes=[],preloadServ=async function(){const _0xf3c63e=_0x127e81;Logger[_0xf3c63e(0x1fc)]('Launching\x20service...');async function _0x99cfdd(){const _0x9be8d4=_0xf3c63e;try{await mClient[_0x9be8d4(0x219)](),sublist=await mClient['db'](_0x9be8d4(0x205))[_0x9be8d4(0x216)](_0x9be8d4(0x211));}catch(_0x33634f){Logger['error'](_0x9be8d4(0x24a)+_0x33634f),process['exit'](0x1);}Logger[_0x9be8d4(0x1fc)]('DB\x20√');}await _0x99cfdd(),Logger['info']('Subconvert\x20√');},fetchNodes=async function(){const _0x42d0e7=_0x127e81;Logger[_0x42d0e7(0x1fc)](_0x42d0e7(0x229));let _0x185d4b=_0x38a795[_0x42d0e7(0x232)](_0x42d0e7(0x230),_0x42d0e7(0x1e1)),_0x382900=[];_0x382900=_0x382900['concat'](_0x185d4b['split']('\x0a'));let _0x4b957b=_0x38a795['readFileSync']('../nodelist.txt',_0x42d0e7(0x214))[_0x42d0e7(0x22b)]('\x0a');for(let _0x22e6f0=0x0;_0x22e6f0<_0x4b957b[_0x42d0e7(0x1fb)];_0x22e6f0++){_0x4b957b[_0x22e6f0]!==''&&nodes[_0x42d0e7(0x23a)](_0x4b957b[_0x22e6f0]);}let _0x2a43b3=await sublist[_0x42d0e7(0x209)]({'PLEASEIGNORE':0x1})[_0x42d0e7(0x1ff)]();for(let _0x1a6d97=0x0;_0x1a6d97<_0x2a43b3[_0x42d0e7(0x1fb)];_0x1a6d97++){_0x382900[_0x42d0e7(0x23a)](_0x2a43b3[_0x1a6d97][_0x42d0e7(0x22a)]);}try{let _0x3b0003=await _0x404bcf('https://github.com/WilliamXor/Mux2sub/raw/main/urllist'),_0x1ab363=_0x3b0003[_0x42d0e7(0x21a)][_0x42d0e7(0x22b)]('\x0a');console[_0x42d0e7(0x1db)]('flist\x20len:'+_0x1ab363[_0x42d0e7(0x1fb)]);for(let _0x45d717=0x0;_0x45d717<_0x1ab363[_0x42d0e7(0x1fb)];_0x45d717++){_0x1ab363[_0x45d717]!==''&&_0x382900[_0x42d0e7(0x23a)](_0x1ab363[_0x45d717]);}Logger[_0x42d0e7(0x1fc)](_0x42d0e7(0x21f)+_0x382900[_0x42d0e7(0x1fb)]+'\x20');}catch(_0x28bcd4){Logger[_0x42d0e7(0x1f9)](_0x42d0e7(0x1ec)+_0x28bcd4);}nodes=nodes[_0x42d0e7(0x225)](await scov[_0x42d0e7(0x1fe)](_0x382900));},output=async function(){const _0x172c53=_0x127e81;Logger[_0x172c53(0x1fc)](_0x172c53(0x207)+nodes[_0x172c53(0x1fb)]+_0x172c53(0x240));let _0x46092e=Buffer[_0x172c53(0x23c)](nodes[_0x172c53(0x227)]('\x0a'))[_0x172c53(0x244)]('base64');return _0x38a795[_0x172c53(0x245)]('out.txt',_0x46092e),Logger['info'](_0x172c53(0x233)),_0x46092e;};async function main(){await preloadServ(),await fetchNodes(),await output(),process['exit']();}main();
