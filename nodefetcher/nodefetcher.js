const a0_0x51b06e=a0_0x5e2f;(function(_0x5c9e4c,_0x329963){const _0x2b055a=a0_0x5e2f,_0x44b8f6=_0x5c9e4c();while(!![]){try{const _0x55657d=-parseInt(_0x2b055a(0x171))/0x1+parseInt(_0x2b055a(0x192))/0x2*(parseInt(_0x2b055a(0x14c))/0x3)+-parseInt(_0x2b055a(0x14b))/0x4*(-parseInt(_0x2b055a(0x17e))/0x5)+-parseInt(_0x2b055a(0x13a))/0x6+-parseInt(_0x2b055a(0x18f))/0x7+parseInt(_0x2b055a(0x16e))/0x8+parseInt(_0x2b055a(0x161))/0x9;if(_0x55657d===_0x329963)break;else _0x44b8f6['push'](_0x44b8f6['shift']());}catch(_0x3277e0){_0x44b8f6['push'](_0x44b8f6['shift']());}}}(a0_0x55db,0xdbda5));import a0_0x3bb0c1 from'child_process';import a0_0x4445e7 from'path';import a0_0x24cfdf from'fs';import a0_0x26f857 from'os';import a0_0x5926dc from'axios';function a0_0x5e2f(_0xdce47a,_0x17a68e){const _0x55db7a=a0_0x55db();return a0_0x5e2f=function(_0x5e2f8a,_0x14c35a){_0x5e2f8a=_0x5e2f8a-0x126;let _0x567247=_0x55db7a[_0x5e2f8a];return _0x567247;},a0_0x5e2f(_0xdce47a,_0x17a68e);}import a0_0x158c39 from'winston';import{MongoClient}from'mongodb';import a0_0x581b62 from'crypto';let pathFile=JSON[a0_0x51b06e(0x160)](a0_0x24cfdf['readFileSync'](a0_0x51b06e(0x176),a0_0x51b06e(0x17d)));async function startSub(){async function _0x1567c9(){return new Promise((_0x42db70,_0x1fe1b0)=>{const _0x4241f7=a0_0x5e2f;let _0x51b975=getPath(_0x4241f7(0x18d)),_0x11a024=a0_0x3bb0c1[_0x4241f7(0x16a)](_0x51b975,[],{'cwd':a0_0x4445e7[_0x4241f7(0x133)](process[_0x4241f7(0x129)](),_0x4241f7(0x165)),'shell':!![]});_0x11a024['stderr']['on']('data',_0x41dadb=>{const _0x517d84=_0x4241f7;let _0x1934f8=Buffer[_0x517d84(0x148)](_0x41dadb)['toString'](_0x517d84(0x17d));_0x1934f8[_0x517d84(0x126)](_0x517d84(0x131))&&_0x42db70();});});}await _0x1567c9();}function getPath(_0x3d4a4b){const _0x2f7357=a0_0x51b06e;try{let _0x403586=a0_0x4445e7[_0x2f7357(0x133)](process['cwd']()+_0x2f7357(0x181)+pathFile[_0x3d4a4b][a0_0x26f857['platform']()][a0_0x26f857[_0x2f7357(0x14a)]()]);return _0x403586;}catch(_0x3caade){throw _0x2f7357(0x14e);}}function checkConfig(_0x3006d9,_0x225737){const _0x2bfa68=a0_0x51b06e;for(let _0x5e2aed=0x0;_0x5e2aed<_0x225737[_0x2bfa68(0x170)];_0x5e2aed++){typeof _0x3006d9[_0x225737[_0x5e2aed]]===_0x2bfa68(0x12a)&&(Logger['error'](_0x2bfa68(0x18e)+_0x225737[_0x5e2aed]+'\x22'),process[_0x2bfa68(0x163)](0x1));}}function randomString(){const _0x57e1ca=a0_0x51b06e;let _0x5b9323='';for(let _0x2afd84=0xf;_0x2afd84>0x0;--_0x2afd84)_0x5b9323+=_0x57e1ca(0x16f)[Math[_0x57e1ca(0x187)](Math[_0x57e1ca(0x18b)]()*_0x57e1ca(0x16f)[_0x57e1ca(0x170)])];return _0x5b9323;}class Timer{constructor(){const _0xbbc9e7=a0_0x51b06e;this[_0xbbc9e7(0x151)]=Date[_0xbbc9e7(0x151)]();}['get'](){const _0x17825c=a0_0x51b06e;return Date[_0x17825c(0x151)]()-this[_0x17825c(0x151)];}}async function convertSub(_0x1fbe59,_0x3d6bf2){const _0x14efc3=a0_0x51b06e;let _0x3c812c=[];for(let _0x3607db=0x0;_0x3607db<_0x1fbe59[_0x14efc3(0x170)];_0x3607db++){_0x3c812c[_0x14efc3(0x17f)](_0x1fbe59[_0x3607db][_0x14efc3(0x15d)]);}Logger[_0x14efc3(0x177)](_0x14efc3(0x13b)+_0x3c812c[_0x14efc3(0x170)]+_0x14efc3(0x127)),Logger[_0x14efc3(0x177)](_0x14efc3(0x137));try{let _0x2444a9=await a0_0x5926dc('http://127.0.0.1:25500/sub?target='+_0x3d6bf2+_0x14efc3(0x152)+encodeURIComponent(_0x3c812c[_0x14efc3(0x133)]('|')));return _0x2444a9[_0x14efc3(0x13d)];}catch(_0x2e1a93){Logger['error'](_0x14efc3(0x154)+_0x2e1a93),process[_0x14efc3(0x163)](0x1);}}async function clearSconvCache(){const _0x5b03ab=a0_0x51b06e;let _0x2dfc26=a0_0x24cfdf[_0x5b03ab(0x130)](_0x5b03ab(0x191));for(let _0x525429=0x0;_0x525429<_0x2dfc26[_0x5b03ab(0x170)];_0x525429++){a0_0x24cfdf[_0x5b03ab(0x132)](_0x5b03ab(0x16b)+_0x2dfc26[_0x525429]);}}var toolbox={'startSub':startSub,'checkConfig':checkConfig,'randomString':randomString,'getPath':getPath,'Timer':Timer,'convertSub':convertSub,'clearSconvCache':clearSconvCache};const levels={'error':0x0,'warn':0x1,'info':0x2,'debug':0x3},level=()=>{const _0x223a9d=a0_0x51b06e,_0x45b0df=process[_0x223a9d(0x128)]['NODE_ENV']||_0x223a9d(0x13e),_0x1caf67=_0x45b0df==='development';return _0x1caf67?'debug':_0x223a9d(0x175);},colors={'error':a0_0x51b06e(0x173),'warn':'yellow','info':a0_0x51b06e(0x167),'debug':a0_0x51b06e(0x153)};a0_0x158c39['addColors'](colors);const format=a0_0x158c39[a0_0x51b06e(0x15a)][a0_0x51b06e(0x145)](a0_0x158c39[a0_0x51b06e(0x15a)][a0_0x51b06e(0x159)]({'format':a0_0x51b06e(0x180)}),a0_0x158c39[a0_0x51b06e(0x15a)][a0_0x51b06e(0x136)]({'all':!![]}),a0_0x158c39['format'][a0_0x51b06e(0x12d)](_0x68fb70=>'['+_0x68fb70[a0_0x51b06e(0x159)]+']['+_0x68fb70[a0_0x51b06e(0x13f)]+']'+_0x68fb70[a0_0x51b06e(0x12c)])),transports=[new a0_0x158c39['transports']['Console'](),new a0_0x158c39[(a0_0x51b06e(0x134))][(a0_0x51b06e(0x15e))]({'filename':'logs/error-'+global['dateStr']+a0_0x51b06e(0x156),'level':a0_0x51b06e(0x15c)}),new a0_0x158c39[(a0_0x51b06e(0x134))][(a0_0x51b06e(0x15e))]({'filename':'logs/all-'+global[a0_0x51b06e(0x162)]+a0_0x51b06e(0x156)})],Logger$1=a0_0x158c39[a0_0x51b06e(0x15f)]({'level':level(),'levels':levels,'format':format,'transports':transports});global[a0_0x51b06e(0x141)]=Logger$1;function unique(_0x58599e,_0x11b3e8){const _0x14cf70=a0_0x51b06e,_0x42a973=new Map();return _0x58599e['filter'](_0x19dfc5=>!_0x42a973[_0x14cf70(0x16c)](_0x19dfc5[_0x11b3e8])&&_0x42a973['set'](_0x19dfc5[_0x11b3e8],0x1));}function a0_0x55db(){const _0x277c21=['url','File','createLogger','parse','5466834WToxmY','dateStr','exit','Subconvert\x20√','/libs/subconverter/','hash','green','stderr','toArray','spawn','./libs/subconverter/cache/','has','Length:','13941536GmaAyH','0123456789abcdefghijklmnopqrstuvwxyz','length','1606734frwwry','close','red','paimonnode','warn','./libs/path.json','info','utf-8','out.txt','The\x20link\x20','update','getPath','utf8','9575HnIxxt','push','YYYY-MM-DD\x20HH:mm:ss:ms','/libs/','Success\x20fetch\x20','./libs/subconverter/','log','Black\x20♂\x20Magic\x20faild.','../sublist.txt','floor','readFileSync','split','concat','random','md5','subconverter','Config\x20Error:Could\x20not\x20find\x20the\x20key\x20\x22','11997258ogzkDh','../nodelist.txt','./libs/subconverter/cache','4RELOce','includes','\x20nodes','env','cwd','undefined','connect','message','printf','profile','\x20in\x20not\x20valid.','readdirSync','Startup\x20completed.\x20Serving\x20HTTP\x20@\x20http://0.0.0.0:25500','unlinkSync','join','transports','link','colorize','Convert-sub:Start\x20convert\x20sub.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20target=mixed\x0a\x20\x20\x20\x20\x20\x20\x20\x20url=','./sconv-log.txt','6548640PFClPC','Start\x20convert\x20sub\x20of\x20','DB\x20√','data','development','level','toString','Logger','createWriteStream','convertList','writeFileSync','combine','https://github.com/WilliamXor/Mux2sub/raw/main/urllist','createHash','from','existsSync','arch','2708bKewXs','2499018TiEuGJ','pipe','Platform\x20unsupported.','base64','hex','now','&remove_emoji=false&url=','white','Error\x20in\x20convert\x20sub.Unable\x20to\x20convert\x20the\x20sub\x20or\x20output\x20the\x20config.','collection','.log','Launching\x20service...','Start\x20fetch\x20nodes.','timestamp','format','./save','error'];a0_0x55db=function(){return _0x277c21;};return a0_0x55db();}class testTask{constructor(_0x4d137d){const _0x2cb5f7=a0_0x51b06e;this[_0x2cb5f7(0x135)]=_0x4d137d,this['hash']=md5(_0x4d137d),this['profile']='['+this[_0x2cb5f7(0x166)]+']\x0a\x20\x20\x20\x20\x20\x20\x20\x20path='+this[_0x2cb5f7(0x166)]+_0x2cb5f7(0x138)+this[_0x2cb5f7(0x135)];}}function md5(_0x1ba4a4){const _0x5ec741=a0_0x51b06e;let _0x5646bf=a0_0x581b62[_0x5ec741(0x147)](_0x5ec741(0x18c));return _0x5646bf[_0x5ec741(0x17b)](_0x1ba4a4)['digest'](_0x5ec741(0x150));}async function convertList(_0x2c6dd5){const _0x50a939=a0_0x51b06e;let _0x486c8f=[];for(let _0xacad79=0x0;_0xacad79<_0x2c6dd5[_0x50a939(0x170)];_0xacad79++){_0x2c6dd5[_0xacad79]!==''&&_0x486c8f['push'](new testTask(_0x2c6dd5[_0xacad79]));}_0x486c8f=unique(_0x486c8f,_0x50a939(0x166));let _0x2cd500='';for(let _0x131282 in _0x486c8f){_0x2cd500+=_0x486c8f[_0x131282][_0x50a939(0x12e)],_0x2cd500+='\x0a';}a0_0x24cfdf[_0x50a939(0x144)]('./libs/subconverter/generate.ini',_0x2cd500),await genConf();let _0x45120a=[],_0x5a2e86=[];for(let _0x10b6b6 in _0x486c8f){let _0x3a46b9=_0x50a939(0x183)+_0x486c8f[_0x10b6b6][_0x50a939(0x166)];if(a0_0x24cfdf[_0x50a939(0x149)](_0x3a46b9)){_0x5a2e86[_0x50a939(0x17f)](_0x486c8f[_0x10b6b6][_0x50a939(0x135)]);let _0x5f45ae=a0_0x24cfdf[_0x50a939(0x188)](_0x3a46b9,_0x50a939(0x17d));a0_0x24cfdf[_0x50a939(0x132)](_0x3a46b9);let _0x118685=Buffer[_0x50a939(0x148)](_0x5f45ae,_0x50a939(0x14f))[_0x50a939(0x140)](_0x50a939(0x17d))['split']('\x0a');Logger[_0x50a939(0x177)](_0x50a939(0x182)+_0x118685[_0x50a939(0x170)]+'\x20from\x20'+_0x486c8f[_0x10b6b6][_0x50a939(0x135)]);for(let _0x14deaa in _0x118685){_0x118685[_0x14deaa]!==''&&_0x45120a[_0x50a939(0x17f)](_0x118685[_0x14deaa]);}}else Logger[_0x50a939(0x175)](_0x50a939(0x17a)+_0x486c8f[_0x10b6b6][_0x50a939(0x135)]+_0x50a939(0x12f));}return a0_0x24cfdf[_0x50a939(0x144)](_0x50a939(0x15b),_0x5a2e86['join']('\x0a')),_0x45120a;}function genConf(){return new Promise(async(_0x57982e,_0x452b11)=>{const _0x402daa=a0_0x5e2f;let _0x38d631=toolbox[_0x402daa(0x17c)](_0x402daa(0x18d)),_0x1744c3=a0_0x24cfdf[_0x402daa(0x142)](_0x402daa(0x139),_0x402daa(0x17d)),_0x7e698d=a0_0x3bb0c1[_0x402daa(0x16a)](_0x38d631,['-g'],{'cwd':a0_0x4445e7['join'](process['cwd'](),_0x402daa(0x165))});_0x7e698d['stderr'][_0x402daa(0x14d)](_0x1744c3),_0x7e698d['on'](_0x402daa(0x163),_0x35bd98=>{_0x57982e();}),_0x7e698d['on'](_0x402daa(0x172),_0x50765c=>{_0x57982e();}),_0x7e698d[_0x402daa(0x168)]['on'](_0x402daa(0x13d),async _0x1f387a=>{const _0x1c25cf=_0x402daa;Buffer[_0x1c25cf(0x148)](_0x1f387a)[_0x1c25cf(0x140)](_0x1c25cf(0x17d));});});}var scov={'convertList':convertList};const mClient=new MongoClient(process[a0_0x51b06e(0x128)]['PAIMONNODE_DB_URI']);let sublist,nodes=[],preloadServ=async function(){const _0x21827e=a0_0x51b06e;Logger[_0x21827e(0x177)](_0x21827e(0x157));async function _0x26905b(){const _0x26ebe2=_0x21827e;try{await mClient[_0x26ebe2(0x12b)](),sublist=await mClient['db'](_0x26ebe2(0x174))[_0x26ebe2(0x155)]('sublist');}catch(_0x32e6fd){Logger[_0x26ebe2(0x15c)]('Cannot\x20connect\x20to\x20the\x20db.'+_0x32e6fd),process[_0x26ebe2(0x163)](0x1);}Logger[_0x26ebe2(0x177)](_0x26ebe2(0x13c));}await _0x26905b(),Logger[_0x21827e(0x177)](_0x21827e(0x164));},fetchNodes=async function(){const _0x1f371d=a0_0x51b06e;Logger[_0x1f371d(0x177)](_0x1f371d(0x158));let _0x24fbb5=a0_0x24cfdf['readFileSync'](_0x1f371d(0x186),_0x1f371d(0x17d)),_0x223dc6=[];_0x223dc6=_0x223dc6[_0x1f371d(0x18a)](_0x24fbb5['split']('\x0a'));let _0x1ecee5=a0_0x24cfdf[_0x1f371d(0x188)](_0x1f371d(0x190),_0x1f371d(0x178))[_0x1f371d(0x189)]('\x0a');for(let _0x5717cc=0x0;_0x5717cc<_0x1ecee5[_0x1f371d(0x170)];_0x5717cc++){_0x1ecee5[_0x5717cc]!==''&&nodes['push'](_0x1ecee5[_0x5717cc]);}let _0x4e438a=await sublist['find']({'PLEASEIGNORE':0x1})[_0x1f371d(0x169)]();for(let _0x2fe341=0x0;_0x2fe341<_0x4e438a[_0x1f371d(0x170)];_0x2fe341++){_0x223dc6[_0x1f371d(0x17f)](_0x4e438a[_0x2fe341]['link']);}try{let _0x495d1a=await a0_0x5926dc(_0x1f371d(0x146)),_0x1da368=_0x495d1a[_0x1f371d(0x13d)][_0x1f371d(0x189)]('\x0a');console[_0x1f371d(0x184)]('flist\x20len:'+_0x1da368[_0x1f371d(0x170)]);for(let _0x1fc19f=0x0;_0x1fc19f<_0x1da368[_0x1f371d(0x170)];_0x1fc19f++){_0x1da368[_0x1fc19f]!==''&&_0x223dc6[_0x1f371d(0x17f)](_0x1da368[_0x1fc19f]);}Logger[_0x1f371d(0x177)]('Black\x20♂\x20Magic:Got\x20'+_0x223dc6[_0x1f371d(0x170)]+'\x20');}catch(_0x4ae36e){Logger[_0x1f371d(0x175)](_0x1f371d(0x185)+_0x4ae36e);}nodes=nodes[_0x1f371d(0x18a)](await scov[_0x1f371d(0x143)](_0x223dc6));},output=async function(){const _0x3796eb=a0_0x51b06e;Logger[_0x3796eb(0x177)](_0x3796eb(0x16d)+nodes[_0x3796eb(0x170)]+'.\x20Start\x20output\x20nodes.');let _0x43fc58=Buffer['from'](nodes[_0x3796eb(0x133)]('\x0a'))['toString'](_0x3796eb(0x14f));return a0_0x24cfdf[_0x3796eb(0x144)](_0x3796eb(0x179),_0x43fc58),Logger[_0x3796eb(0x177)]('Output\x20√'),_0x43fc58;};async function main(){await preloadServ(),await fetchNodes(),await output(),process['exit']();}main();
