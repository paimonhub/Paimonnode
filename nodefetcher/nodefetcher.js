const a0_0xbc70cd=a0_0x2c0f;(function(_0x3dd39d,_0x283390){const _0xf7b373=a0_0x2c0f,_0x2a96d9=_0x3dd39d();while(!![]){try{const _0x3e0991=parseInt(_0xf7b373(0x1a8))/0x1+-parseInt(_0xf7b373(0x171))/0x2+parseInt(_0xf7b373(0x1bc))/0x3+-parseInt(_0xf7b373(0x155))/0x4*(-parseInt(_0xf7b373(0x19e))/0x5)+parseInt(_0xf7b373(0x18c))/0x6*(-parseInt(_0xf7b373(0x160))/0x7)+-parseInt(_0xf7b373(0x18b))/0x8+-parseInt(_0xf7b373(0x193))/0x9*(-parseInt(_0xf7b373(0x17f))/0xa);if(_0x3e0991===_0x283390)break;else _0x2a96d9['push'](_0x2a96d9['shift']());}catch(_0x567858){_0x2a96d9['push'](_0x2a96d9['shift']());}}}(a0_0x3f31,0xb8898));import a0_0x1fb4a2 from'child_process';import a0_0x25d43b from'path';import a0_0x121430 from'fs';import a0_0xa2ecfc from'os';import a0_0x5b0a3a from'axios';import a0_0xa901ca from'winston';import{MongoClient}from'mongodb';import a0_0x45bdaa from'crypto';let pathFile=JSON[a0_0xbc70cd(0x191)](a0_0x121430['readFileSync'](a0_0xbc70cd(0x16b),'utf8'));async function startSub(){async function _0x12085b(){return new Promise((_0x375781,_0x34f47d)=>{const _0x5422e4=a0_0x2c0f;let _0xb53e52=getPath(_0x5422e4(0x17a)),_0x43e08f=a0_0x1fb4a2[_0x5422e4(0x195)](_0xb53e52,[],{'cwd':a0_0x25d43b[_0x5422e4(0x19a)](process['cwd'](),_0x5422e4(0x1b3)),'shell':!![]});_0x43e08f['stderr']['on'](_0x5422e4(0x153),_0x5cbb1c=>{const _0x4807e2=_0x5422e4;let _0x18be26=Buffer[_0x4807e2(0x15a)](_0x5cbb1c)['toString']('utf8');_0x18be26[_0x4807e2(0x16e)](_0x4807e2(0x156))&&_0x375781();});});}await _0x12085b();}function getPath(_0x1f122d){const _0x42e39c=a0_0xbc70cd;try{let _0x108e66=a0_0x25d43b[_0x42e39c(0x19a)](process[_0x42e39c(0x1ad)]()+_0x42e39c(0x1a2)+pathFile[_0x1f122d][a0_0xa2ecfc[_0x42e39c(0x16d)]()][a0_0xa2ecfc[_0x42e39c(0x197)]()]);return _0x108e66;}catch(_0x579283){throw _0x42e39c(0x1a5);}}function checkConfig(_0x5dd3e2,_0x2e8102){const _0x5db161=a0_0xbc70cd;for(let _0x3e356b=0x0;_0x3e356b<_0x2e8102[_0x5db161(0x1b8)];_0x3e356b++){typeof _0x5dd3e2[_0x2e8102[_0x3e356b]]===_0x5db161(0x175)&&(Logger['error'](_0x5db161(0x15d)+_0x2e8102[_0x3e356b]+'\x22'),process[_0x5db161(0x1b9)](0x1));}}function randomString(){const _0x4becbe=a0_0xbc70cd;let _0x54218d='';for(let _0x29d6fd=0xf;_0x29d6fd>0x0;--_0x29d6fd)_0x54218d+='0123456789abcdefghijklmnopqrstuvwxyz'[Math[_0x4becbe(0x1b6)](Math[_0x4becbe(0x164)]()*'0123456789abcdefghijklmnopqrstuvwxyz'[_0x4becbe(0x1b8)])];return _0x54218d;}class Timer{constructor(){const _0x361f27=a0_0xbc70cd;this['now']=Date[_0x361f27(0x1a6)]();}[a0_0xbc70cd(0x17d)](){const _0x3a20c9=a0_0xbc70cd;return Date[_0x3a20c9(0x1a6)]()-this['now'];}}async function convertSub(_0x3fb970,_0x306ade){const _0x5de2e2=a0_0xbc70cd;let _0x692ff7=[];for(let _0x5e7902=0x0;_0x5e7902<_0x3fb970[_0x5de2e2(0x1b8)];_0x5e7902++){_0x692ff7['push'](_0x3fb970[_0x5e7902][_0x5de2e2(0x15c)]);}Logger[_0x5de2e2(0x199)](_0x5de2e2(0x178)+_0x692ff7[_0x5de2e2(0x1b8)]+_0x5de2e2(0x162)),Logger[_0x5de2e2(0x199)](_0x5de2e2(0x1aa));try{let _0x592eb5=await a0_0x5b0a3a(_0x5de2e2(0x169)+_0x306ade+_0x5de2e2(0x187)+encodeURIComponent(_0x692ff7['join']('|')));return _0x592eb5[_0x5de2e2(0x153)];}catch(_0x4f63cb){Logger[_0x5de2e2(0x185)](_0x5de2e2(0x180)+_0x4f63cb),process[_0x5de2e2(0x1b9)](0x1);}}async function clearSconvCache(){const _0x29986b=a0_0xbc70cd;let _0x23b450=a0_0x121430[_0x29986b(0x1c0)]('./libs/subconverter/cache');for(let _0x114a9f=0x0;_0x114a9f<_0x23b450[_0x29986b(0x1b8)];_0x114a9f++){a0_0x121430[_0x29986b(0x163)](_0x29986b(0x170)+_0x23b450[_0x114a9f]);}}var toolbox={'startSub':startSub,'checkConfig':checkConfig,'randomString':randomString,'getPath':getPath,'Timer':Timer,'convertSub':convertSub,'clearSconvCache':clearSconvCache};const levels={'error':0x0,'warn':0x1,'info':0x2,'debug':0x3},level=()=>{const _0x50220d=a0_0xbc70cd,_0x58532c=process[_0x50220d(0x158)]['NODE_ENV']||_0x50220d(0x16a),_0x3acbac=_0x58532c==='development';return _0x3acbac?'debug':_0x50220d(0x1a4);},colors={'error':a0_0xbc70cd(0x1b2),'warn':a0_0xbc70cd(0x16c),'info':a0_0xbc70cd(0x190),'debug':a0_0xbc70cd(0x177)};a0_0xa901ca['addColors'](colors);const format=a0_0xa901ca[a0_0xbc70cd(0x188)][a0_0xbc70cd(0x159)](a0_0xa901ca[a0_0xbc70cd(0x188)][a0_0xbc70cd(0x161)]({'format':'YYYY-MM-DD\x20HH:mm:ss:ms'}),a0_0xa901ca[a0_0xbc70cd(0x188)][a0_0xbc70cd(0x172)]({'all':!![]}),a0_0xa901ca[a0_0xbc70cd(0x188)][a0_0xbc70cd(0x196)](_0x274824=>'['+_0x274824[a0_0xbc70cd(0x161)]+']['+_0x274824[a0_0xbc70cd(0x198)]+']'+_0x274824[a0_0xbc70cd(0x154)])),transports=[new a0_0xa901ca[(a0_0xbc70cd(0x176))][(a0_0xbc70cd(0x18a))](),new a0_0xa901ca[(a0_0xbc70cd(0x176))][(a0_0xbc70cd(0x1ba))]({'filename':a0_0xbc70cd(0x15b)+global['dateStr']+'.log','level':'error'}),new a0_0xa901ca[(a0_0xbc70cd(0x176))][(a0_0xbc70cd(0x1ba))]({'filename':a0_0xbc70cd(0x18d)+global['dateStr']+a0_0xbc70cd(0x1be)})],Logger$1=a0_0xa901ca[a0_0xbc70cd(0x179)]({'level':level(),'levels':levels,'format':format,'transports':transports});function a0_0x3f31(){const _0x75fed=['printf','arch','level','info','join','writeFileSync','.\x20Start\x20output\x20nodes.','toString','10845hjTdVF','existsSync','getPath','utf8','/libs/','Black\x20♂\x20Magic:Got\x20','warn','Platform\x20unsupported.','now','toArray','1363490vcPihj','./libs/subconverter/generate.ini','Convert-sub:Start\x20convert\x20sub.','out.txt','connect','cwd','https://github.com/WilliamXor/Mux2sub/raw/main/urllist','createHash','update','split','red','/libs/subconverter/','Output\x20√','DB\x20√','floor','link','length','exit','File','flist\x20len:','2895273CMDkAP','push','.log','log','readdirSync',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20path=','../nodelist.txt','data','message','1504zSXgya','Startup\x20completed.\x20Serving\x20HTTP\x20@\x20http://0.0.0.0:25500','\x20in\x20not\x20valid.','env','combine','from','logs/error-','url','Config\x20Error:Could\x20not\x20find\x20the\x20key\x20\x22','has','hex','206843LsuEcf','timestamp','\x20nodes','unlinkSync','random','Subconvert\x20√','./libs/subconverter/','Logger','Black\x20♂\x20Magic\x20faild.','http://127.0.0.1:25500/sub?target=','development','./libs/path.json','yellow','platform','includes','base64','./libs/subconverter/cache/','2617006lBKikd','colorize','utf-8','\x20from\x20','undefined','transports','white','Start\x20convert\x20sub\x20of\x20','createLogger','subconverter','readFileSync','profile','get','close','943950TqNkss','Error\x20in\x20convert\x20sub.Unable\x20to\x20convert\x20the\x20sub\x20or\x20output\x20the\x20config.','find','hash','Launching\x20service...','sublist','error','Start\x20fetch\x20nodes.','&remove_emoji=false&url=','format','convertList','Console','11783712uAtbgs','246qluFuL','logs/all-','PAIMONNODE_DB_URI','set','green','parse','../sublist.txt','153gXLKOa','\x0a\x20\x20\x20\x20\x20\x20\x20\x20target=mixed\x0a\x20\x20\x20\x20\x20\x20\x20\x20url=','spawn'];a0_0x3f31=function(){return _0x75fed;};return a0_0x3f31();}global[a0_0xbc70cd(0x167)]=Logger$1;function a0_0x2c0f(_0x11d8e7,_0x26d366){const _0x3f31d6=a0_0x3f31();return a0_0x2c0f=function(_0x2c0f70,_0x29d773){_0x2c0f70=_0x2c0f70-0x151;let _0x21a187=_0x3f31d6[_0x2c0f70];return _0x21a187;},a0_0x2c0f(_0x11d8e7,_0x26d366);}function unique(_0x2da4a7,_0x1e21e9){const _0x304c15=a0_0xbc70cd,_0x3bec43=new Map();return _0x2da4a7['filter'](_0x375737=>!_0x3bec43[_0x304c15(0x15e)](_0x375737[_0x1e21e9])&&_0x3bec43[_0x304c15(0x18f)](_0x375737[_0x1e21e9],0x1));}class testTask{constructor(_0x2f78e2){const _0x2ddf6b=a0_0xbc70cd;this[_0x2ddf6b(0x1b7)]=_0x2f78e2,this[_0x2ddf6b(0x182)]=md5(_0x2f78e2),this[_0x2ddf6b(0x17c)]='['+this[_0x2ddf6b(0x182)]+_0x2ddf6b(0x151)+this['hash']+_0x2ddf6b(0x194)+this[_0x2ddf6b(0x1b7)];}}function md5(_0x296fd9){const _0x3fdf27=a0_0xbc70cd;let _0x54c3cb=a0_0x45bdaa[_0x3fdf27(0x1af)]('md5');return _0x54c3cb[_0x3fdf27(0x1b0)](_0x296fd9)['digest'](_0x3fdf27(0x15f));}async function convertList(_0x14d41d){const _0x315c88=a0_0xbc70cd;let _0xbb0717=[];for(let _0x23f2cc=0x0;_0x23f2cc<_0x14d41d[_0x315c88(0x1b8)];_0x23f2cc++){_0x14d41d[_0x23f2cc]!==''&&_0xbb0717[_0x315c88(0x1bd)](new testTask(_0x14d41d[_0x23f2cc]));}_0xbb0717=unique(_0xbb0717,_0x315c88(0x182));let _0x4cab5c='';for(let _0x442694 in _0xbb0717){_0x4cab5c+=_0xbb0717[_0x442694][_0x315c88(0x17c)],_0x4cab5c+='\x0a';}a0_0x121430[_0x315c88(0x19b)](_0x315c88(0x1a9),_0x4cab5c),await genConf();let _0xce6847=[],_0x40f5c=[];for(let _0x38234f in _0xbb0717){let _0x588a25=_0x315c88(0x166)+_0xbb0717[_0x38234f]['hash'];if(a0_0x121430[_0x315c88(0x19f)](_0x588a25)){_0x40f5c['push'](_0xbb0717[_0x38234f][_0x315c88(0x1b7)]);let _0x14bf2d=a0_0x121430[_0x315c88(0x17b)](_0x588a25,_0x315c88(0x1a1));a0_0x121430[_0x315c88(0x163)](_0x588a25);let _0x3df641=Buffer['from'](_0x14bf2d,_0x315c88(0x16f))[_0x315c88(0x19d)](_0x315c88(0x1a1))[_0x315c88(0x1b1)]('\x0a');Logger['info']('Success\x20fetch\x20'+_0x3df641['length']+_0x315c88(0x174)+_0xbb0717[_0x38234f]['link']);for(let _0x2a0e6f in _0x3df641){_0x3df641[_0x2a0e6f]!==''&&_0xce6847[_0x315c88(0x1bd)](_0x3df641[_0x2a0e6f]);}}else Logger['warn']('The\x20link\x20'+_0xbb0717[_0x38234f][_0x315c88(0x1b7)]+_0x315c88(0x157));}return a0_0x121430[_0x315c88(0x19b)]('./save',_0x40f5c[_0x315c88(0x19a)]('\x0a')),_0xce6847;}function genConf(){return new Promise(async(_0x373e9e,_0x361d58)=>{const _0x287cc2=a0_0x2c0f;let _0x1afbf3=toolbox[_0x287cc2(0x1a0)](_0x287cc2(0x17a)),_0x5a638a=a0_0x1fb4a2[_0x287cc2(0x195)](_0x1afbf3,['-g'],{'cwd':a0_0x25d43b['join'](process[_0x287cc2(0x1ad)](),_0x287cc2(0x1b3))});_0x5a638a['on'](_0x287cc2(0x1b9),_0x279500=>{_0x373e9e();}),_0x5a638a['on'](_0x287cc2(0x17e),_0x41cb19=>{_0x373e9e();}),_0x5a638a['stderr']['on']('data',async _0x533115=>{const _0x501dd8=_0x287cc2;Buffer[_0x501dd8(0x15a)](_0x533115)[_0x501dd8(0x19d)](_0x501dd8(0x1a1));});});}var scov={'convertList':convertList};const mClient=new MongoClient(process[a0_0xbc70cd(0x158)][a0_0xbc70cd(0x18e)]);let sublist,nodes=[],preloadServ=async function(){const _0x37e514=a0_0xbc70cd;Logger[_0x37e514(0x199)](_0x37e514(0x183));async function _0x102b33(){const _0x216ae6=_0x37e514;try{await mClient[_0x216ae6(0x1ac)](),sublist=await mClient['db']('paimonnode')['collection'](_0x216ae6(0x184));}catch(_0x3ec003){Logger[_0x216ae6(0x185)]('Cannot\x20connect\x20to\x20the\x20db.'+_0x3ec003),process[_0x216ae6(0x1b9)](0x1);}Logger['info'](_0x216ae6(0x1b5));}await _0x102b33(),Logger[_0x37e514(0x199)](_0x37e514(0x165));},fetchNodes=async function(){const _0x32b162=a0_0xbc70cd;Logger[_0x32b162(0x199)](_0x32b162(0x186));let _0x4c0099=a0_0x121430[_0x32b162(0x17b)](_0x32b162(0x192),_0x32b162(0x1a1)),_0x21fea3=[];_0x21fea3=_0x21fea3['concat'](_0x4c0099[_0x32b162(0x1b1)]('\x0a'));let _0x58760b=a0_0x121430[_0x32b162(0x17b)](_0x32b162(0x152),_0x32b162(0x173))[_0x32b162(0x1b1)]('\x0a');for(let _0x1ff089=0x0;_0x1ff089<_0x58760b[_0x32b162(0x1b8)];_0x1ff089++){_0x58760b[_0x1ff089]!==''&&nodes[_0x32b162(0x1bd)](_0x58760b[_0x1ff089]);}let _0x324527=await sublist[_0x32b162(0x181)]({'PLEASEIGNORE':0x1})[_0x32b162(0x1a7)]();for(let _0x47f760=0x0;_0x47f760<_0x324527[_0x32b162(0x1b8)];_0x47f760++){_0x21fea3[_0x32b162(0x1bd)](_0x324527[_0x47f760]['link']);}try{let _0x4c61e2=await a0_0x5b0a3a(_0x32b162(0x1ae)),_0x41e64b=_0x4c61e2[_0x32b162(0x153)]['split']('\x0a');console[_0x32b162(0x1bf)](_0x32b162(0x1bb)+_0x41e64b[_0x32b162(0x1b8)]);for(let _0x4fd765=0x0;_0x4fd765<_0x41e64b[_0x32b162(0x1b8)];_0x4fd765++){_0x41e64b[_0x4fd765]!==''&&_0x21fea3['push'](_0x41e64b[_0x4fd765]);}Logger[_0x32b162(0x199)](_0x32b162(0x1a3)+_0x21fea3[_0x32b162(0x1b8)]+'\x20');}catch(_0x45f750){Logger[_0x32b162(0x1a4)](_0x32b162(0x168)+_0x45f750);}nodes=nodes['concat'](await scov[_0x32b162(0x189)](_0x21fea3));},output=async function(){const _0x42dcc7=a0_0xbc70cd;Logger[_0x42dcc7(0x199)]('Length:'+nodes['length']+_0x42dcc7(0x19c));let _0x35de63=Buffer['from'](nodes[_0x42dcc7(0x19a)]('\x0a'))[_0x42dcc7(0x19d)](_0x42dcc7(0x16f));return a0_0x121430[_0x42dcc7(0x19b)](_0x42dcc7(0x1ab),_0x35de63),Logger[_0x42dcc7(0x199)](_0x42dcc7(0x1b4)),_0x35de63;};async function main(){await preloadServ(),await fetchNodes(),await output(),process['exit']();}main();
